@model IEnumerable<ODHDEVELOPERS.Models.appltab>
@using ODHDEVELOPERS.Models
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewBag.Title = "UpdateManualBond";
   
    var a = 0;
    var branch = string.Empty;
    UsersContext db = new UsersContext();
    
    var tr = db.TDSLF_tabs.Single(f => f.Id == 1);

    var mr = db.Members.Single(m => m.Id == 1);
    var plan1 = db.Plans.Single(p1 => p1.Plancode == 1);
    var plan2 = db.Plans.Single(p2 => p2.Plancode == 2);
    var plan3 = db.Plans.Single(p3 => p3.Plancode == 3);
    var plan4 = db.Plans.Single(p4 => p4.Plancode == 4);
}

<link rel="stylesheet" href="~/Content/jquery-ui.css" />

<script type="text/javascript">
    $(document).ready(function () {
        $("#newbond").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/Branch/AutoCompleteManualBondId",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.name, value: item.newbondid };
                        }))
                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });
    })
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#IntroducerCode").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/Admin/AutoCompleteAgentId",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.name, value: item.NewAgentId };


                        }))

                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });


    })
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#nomrel").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/Admin/AutoCompleteRelations",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.relations, value: item.relations };


                        }))

                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });


    })
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#gurrel").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/Admin/AutoCompleteRelations",
                    type: "POST",
                    dataType: "json",
                    data: { term: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.relations, value: item.relations };


                        }))

                    }
                })
            },
            messages: {
                noResults: "", results: ""
            }
        });


    })
</script>



<script type="text/javascript">
    function check(check_id) {

        $("#" + check_id).click(function () {
            $('.plantype').prop('checked', false);
        });

    }
   
    function selectexpiry(term_id) {

        var term = $("#" + term_id).val();
        var formdate = $("#formdate").val();

        var url = '@Url.Action("selectexpiry", "Branch")';
            $.get(url, { term: term, formdate: formdate }, function data(t) {

                for (var i = 0; i < t.length; i++) {
                    var date = new Date(parseInt(t[i].expirydate.replace("/Date(", "").replace(")/", ""), 10));
                    var day = ('0' + date.getDate()).slice(-2);
                    var month = ('0' + (date.getMonth() + 1)).slice(-2);
                    var parsedDate = (month) + "/" + (day) + "/" + date.getFullYear();
                    $('#expirydate').val(parsedDate);

                }
            });
        }

    function selectduedate(mode_id) {

        var mode = $("#" + mode_id).val();
        var formdate = $("#formdate").val();

        var url = '@Url.Action("selectduedate", "Branch")';
        $.get(url, { mode: mode, formdate: formdate }, function data(t) {

            for (var i = 0; i < t.length; i++) {
                var date = new Date(parseInt(t[i].expirydate.replace("/Date(", "").replace(")/", ""), 10));
                var day = ('0' + date.getDate()).slice(-2);
                var month = ('0' + (date.getMonth() + 1)).slice(-2);
                var parsedDate = (month) + "/" + (day) + "/" + date.getFullYear();
                $('#pdate').val(parsedDate);

            }
        });
    }

</script>
<script>
    function SetBookingAmount(checkid) {

        var plotsize = $("#" + checkid).val();
        var url = '@Url.Action("CalBooking", "Branch")';
        $.get(url, { plotsize: plotsize }, function data(t) {
            for (var i = 0; i < t.length; i++) {

                $("#bookingamount").val(t[i].bookingamount);
            }
        });

    }

    function SetAmountinword(checkid) {

        var payment = $("#" + checkid).val();
        var url = '@Url.Action("SetAmountinword", "Branch")';
        $.get(url, { payment: payment }, function data(t) {
            for (var i = 0; i < t.length; i++) {

                $("#amountinword").val(t[i].amountword);
            }
        });

    }
</script>


<div class="page-content">

    <div class="container">



        <div class="page-toolbar">

            <div class="page-toolbar-block">
                <div class="page-toolbar-title">Update Manual @mr.custname</div>
                <div class="page-toolbar-subtitle"></div>
            </div>

            <div class="page-toolbar-block pull-right">
            </div>

        </div>
        @using (Html.BeginForm("UpdateManualBond", "Admin", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {

            <div class="row">
                <div class="col-md-6" style="width: 100%">

                    <div class="block">

                        <div class="block-content controls">

                            <div class="row-form">

                                <div class="col-md-9">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <label class="width">Enter @mr.custname Id</label></span>
                                        <input type="text" class="form-control" name="newbond" id="newbond">
                                    </div>

                                </div>
                            </div>

                            <div class="page-toolbar-block pull-right">
                                <div class="widget-info widget-from">

                                    <button type="submit" value="Search" name="command" class="btn btn-primary"><i class="fa fa-search"></i>Search</button>

                                </div>
                            </div>

                        </div>

                    </div>
                </div>

                @foreach (var item in Model)
                {
                    if (a == 0)
                    {

                    <div class="col-md-6">

                        <div class="block">
                            <div class="block-content">
                                <h2><strong>Personal Details</strong></h2>
                            </div>
                            <div class="block-content controls">

                                <div class="row-form">

                                    <div class="col-md-9">
                                        @if (branch == "")
                                        {
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <label class="width">@mr.branchname Code </label>
                                                </span>
                                                <input type="text" class="form-control " id="BranchCode" name="BranchCode" value="@item.branchcode" readonly="true"/>
                                            </div>
                                              
                                             }

                                        else
                                        {
                                            <div class="input-group">
                                                <span class="input-group-addon">
                                                    <label class="width">@mr.branchname Code </label>
                                                </span>
                                                <input type="text" id="branchcode" class="form-control" readonly="true" value="@branch" name="branchcode" required />
                                            </div>
                                             }

                                    </div>
                                </div>
                                <div class="row-form">
                                    <div class="col-md-9">

                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Form Fee</label></span>
                                            <input type="text" class="form-control" id="applicationcharge" required name="applicationcharge" value="@item.applicationcharge" readonly="true"/>
                                        </div>

                                    </div>

                                </div>
                                <div class="row-form">
                                    <div class="col-md-9">

                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Discount(%)</label></span>
                                            <input type="text" class="form-control" id="discountper" required name="discountper"  value="@item.discountper" />
                                        </div>

                                    </div>

                                </div>
                                <div class="row-form">
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Name of Applicant </label>
                                            </span>

                                            <input type="text" class="form-control" id="name" name="name" value="@item.name" required />
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">@mr.custname Id </label>
                                            </span>

                                            <input type="text" class="form-control" id="newbondid" name="newbondid" value="@item.newbondid" required readonly="true"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group" style="float: left;">
                                            <span class="input-group-addon">
                                                <label class="width">Father/Husband Name </label>
                                            </span>
                                            <div style="float: left; width: 29%">
                                                <select class="form-control" id="RelationOf" name="RelationOf">
                                                    <option selected>S/O </option>
                                                    <option>D/O </option>
                                                    <option>W/O </option>

                                                </select>
                                            </div>
                                            <div style="float: left; width: 71%;">
                                                <input type="text" class="form-control" id="fathername" value="@item.fathername" name="fathername" required/>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Address </label>
                                            </span>
                                            <input type="text" id="addr" name="addr" value="@item.addr" class="form-control" required >
                                        </div>
                                    </div>
                                </div>


                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Mobile No </label>
                                            </span>
                                            <input type="text" id="mobileno" name="mobileno" value="@item.mobileno" maxlength="10" class="form-control" required/>
                                        </div>
                                    </div>
                                </div>



                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Introducer Code </label>
                                            </span>
                                            <input type="text" class="form-control"   value="@item.newintroducerid" id="IntroducerCode" name="newintroducerid" required />
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">

                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Date of Agreement </label>
                                            </span>
                                            <input type="text" class="form-control datepicker" id="formdate" value="@item.formdate" name="formdate" required >
                                        </div>

                                    </div>
                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">

                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Age/DOB </label>
                                            </span>
                                            <input type="text" id="age" value="@item.age"  name="age" class="form-control" required/>
                                        </div>
                                    </div>

                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Nationality </label>
                                            </span>
                                            <input type="text" id="nationality" name="nationality" readonly="true" class="form-control"  value="@item.nationality"/>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>





                        <div class="block">
                            <div class="block-content">
                                <h2><strong>Guardian Details</strong></h2>

                            </div>
                            <div class="block-content controls">

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Guardian Name </label>
                                            </span>
                                            <input type="text" id="guardianname" value="@item.guardianname" name="guardianname" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Guardian's Age </label>
                                            </span>
                                            <input type="text" id="gurage" name="gurage" value="@item.gurage" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Relationship</label></span>
                                            <input type="text" class="form-control" id="gurrel" value="@item.gurrel" name="gurrel" />
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Guardian Address</label></span>
                                            <input id="guraddr" name="guraddr" value="@item.guraddr" class="form-control">
                                        </div>
                                    </div>
                                </div>


                                <div class="row-form">

                                    <div class="col-md-9">


                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Upload Image</label></span>
                                            <input class="form-control" id="File1" name="photo" type="file" />


                                        </div>

                                    </div>
                                </div>

                                <img alt="" src="@Url.Content(item.photo)" style="height:200px;width:150px;"/>

                            </div>

                        </div>


                        <div class="block">
                            <div class="block-content">
                                <h2><strong>Bank Details</strong></h2>

                            </div>
                            <div class="block-content controls">

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">PAN No </label>
                                            </span>
                                            <input type="text" id="panno" value="@item.panno" name="panno" class="form-control" />
                                        </div>
                                    </div>
                                </div>


                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Bank Name </label>
                                            </span>
                                            <input type="text" id="bankname" value="@item.bankname" name="bankname" class="form-control"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Bank A/C No </label>
                                            </span>
                                            <input type="text" id="accountno" name="accountno" value="@item.accountno" class="form-control"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">IFSC Code </label>
                                            </span>
                                            <input type="text" id="IFSC"  value=" @Html.DisplayFor(modelItem => item.IFSC)" name="IFSC" class="form-control"/>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>

                    </div> 

                    <div class="col-md-6">

                        <div class="block">
                            <div class="block-content">
                                <h2><strong>@mr.planname Details</strong> </h2>

                            </div>
                            <div class="block-content controls">
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">

                                            <span class="input-group-addon">
                                                <label class="width">@mr.planname Type</label></span>

                                           <input type="radio" name="plantype" class="plantype" checked="checked" value="@Html.DisplayFor(modelItem => item.plantype)" id="FI" />Installment 

                                        </div>

                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">@mr.planname Name </label>
                                            </span>
                                          <input id="planname" type="text" class="form-control" value="@Html.DisplayFor(modelItem => item.planname)" name="planname" required />
                                        </div>

                                    </div>

                                </div>

                                

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Term(Yr.) </label>
                                            </span>
                                            <input type="text" class="form-control" value="@item.term" name="term" id="term" onclick="selectexpiry(this.id)" required/>
                                        </div>
                                    </div>
                                </div>


                                <div class="row-form">
                                   <div class="col-md-9">
                                       <div class="input-group">
                                           <span class="input-group-addon">
                                               <label class="width">@mr.planname Mode </label>
                                           </span>
                                           <select class="form-control" id="mode" name="mode" onclick="selectduedate(this.id)" required>
                                               <option selected value="@item.mode">@item.mode</option>
                                               <option value="Monthly">Monthly</option>
                                               <option value="Quarterly">Quarterly</option>
                                               <option value="Halfyearly">Halfyearly</option>
                                               <option value="Yearly">Yearly</option>
                                           </select>
                                       </div>
                                   </div>
                               </div>

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Payment(Rs.) </label>
                                            </span>
                                          <input id="payment" type="text" class="form-control" value="@item.payment" name="payment" required />

                                        </div>

                                    </div>
                                </div>

                                <div class="row-form">
                                   <div class="col-md-9">
                                       <div class="input-group">
                                           <span class="input-group-addon">
                                               <label class="width">Advance Payment</label></span>
                                           <input id="downpayment" name="downpayment" value="@item.downpayment" type="text" class="form-control" required />
                                       </div>
                                   </div>
                               </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Plot Size(SqYd)</label></span>
                                            <input type="text" id="nolandunit" value="@item.nolandunit" name="nolandunit" onclick="SetBookingAmount(this.id)"  class="form-control" required/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">
                                       
                                        <div class="col-md-9">
                                            <div class="input-group">
       <span class="input-group-addon"><label class="width">Booking Amount</label></span>  
                                            <input id="bookingamount" name="bookingamount" onclick="SetAmountinword(this.id)" value="@item.bookingamount" type="text" class="form-control" required/></div>
                                    </div>
                                         </div>
                                
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Total Consideration(Rs.) </label>
                                            </span>
                                            <input type="text" value="@item.totalcon" class="form-control" id="Totalamount" name="totalcon"  required />
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Maturity Amount(Rs.)</label></span>
                                            <input type="text" class="form-control" value="@item.expectedraisablevalue" id="maturityamt" name="expectedraisablevalue"  required/>

                                        </div>

                                    </div>
                                </div>



                                <div class="row-form">

                                    <div class="col-md-9">

                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Expiry Date</label></span>
                                            <input type="text" class="form-control datepicker" value="@item.expirydate" id="expirydate" name="expirydate" readonly="true" required/>
                                        </div>


                                    </div>
                                </div>




                            </div>
                        </div>

                        <div class="block">
                            <div class="block-content">
                                <h2><strong>Nominee Details</strong> </h2>

                            </div>
                            <div class="block-content controls">

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Nominee Name </label>
                                            </span>
                                            <input type="text" value="@item.nomineename" id="nomineename" name="nomineename" class="form-control"/ required>
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Nominee Age </label>
                                            </span>
                                            <input type="text" id="nomage" name="nomage" value="@item.nomage" class="form-control" required/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Relationship </label>
                                            </span>
                                            <input type="text" class="form-control" value="@item.nomrel" id="nomrel" name="nomrel" required/>
                                        </div>
                                    </div>
                                </div>

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Nominee Address </label>
                                            </span>
                                            <input type="text" id="nomaddr" name="nomaddr" value="@item.nomaddr" class="form-control" required />
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="block">
                            <div class="block-content">
                                <h2><strong>Payment Details</strong> </h2>

                            </div>
                            <div class="block-content controls">

                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Payment Mode </label>
                                            </span>

                                            <input type="radio" name="paymethod" value="Cash" checked="checked" />
                                            Cash   
                                             <input type="radio" name="paymethod" value="DD">
                                            DD  
                                          <input type="radio" name="paymethod" value="Cheque">
                                            Cheque  


                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">

                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Payment Date</label></span>
                                            <input type="text" id="pdate" name="pdate" class="form-control datepicker" value="@item.pdate" required />
                                        </div>

                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Cheque/ DD No. </label>
                                            </span>
                                            <input type="text" value="@item.checkorddno" id="checkorddno" name="checkorddno"  class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Draw No. </label>
                                            </span>
                                            <input type="text" id="drawno" name="drawno" value="@item.drawno" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Branch Payable At </label>
                                            </span>
                                            <input type="text" id="branchpay" name="branchpay" value="@item.branchpay" class="form-control" />
                                        </div>
                                    </div>
                                </div>


                                <div class="row-form">

                                    <div class="col-md-9">
                                        <div class="input-group">
                                            <span class="input-group-addon">
                                                <label class="width">Amount In Words </label>
                                            </span>
                                            <input type="text" name="amountword"  class="form-control" value="@item.amountword" id="amountinword" readonly="true" required/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-md-6" style="width: 100%">
                        <div class="block">
                            <div class="block-content controls">
                                <div style="margin-left: 46%;">
                                    <div class="widget-info widget-from">

                                        <button id="submit" type="submit" name="command" value="Update" class="btn btn-primary" onclick="return confirm('Are you sure to update @mr.custname??')">Update</button>

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>
                             
                             }
                         }

            </div>           
                      }
        <div style="float: left; margin-left: 30px;">
            <p style="color: maroon;"><b>@ViewBag.msg</b></p>
            @if (ViewBag.msg == "Bond Updated Successfully....")
            {
                @Html.ActionLink("Print Bond", "PrintBond", new { newbondid = ViewData["newbondid"] }, new { onclick = "return confirm('Are you sure to Print this Bond?');" })
                                    }
        </div>
    </div>
</div>
